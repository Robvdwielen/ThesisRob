---
title: "Plots_interaction"
author: "Rob van der Wielen"
date: "2023-03-25"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(gridExtra)
```

#--- Loading in Data ---#

```{r}
regressionData <- read.csv("C:/Users/Systeembeheer/OneDrive - Tilburg University/Documenten/Master/Marketing Analytics/Thesis/ThesisRob/ThesisRob/Datasets/Cleaned_data/RegressionData.csv")

```

#--- Creating interaction plot for genre variable ---#

```{r}
#creating interaction plots

pdf("plots/interaction_genre.pdf") 
# calculating mean and SD
mean <- mean(regressionData$Holiday_distance)
sd <- sd(regressionData$Holiday_distance)

# plot interactions
regressionData$hd_level <- ifelse(regressionData$Holiday_distance > mean + sd, "+1SD Mean", 
                           ifelse(regressionData$Holiday_distance < mean - sd, "-1SD Mean", "Mean"))

# Plotting parameters
theme_set(theme_minimal())
colors <- c("#E41A1C", "#377EB8", "#4DAF4A")

# Plot interactions
ggplot(regressionData, aes(x = AVG_Ngenre_comp, y = cumulative_rank, color = hd_level)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.2, linetype = "dashed") +
  labs(x = "Average amount of competitor genre videos",
       y = "Cumulative Rank",
       color = "Holiday Distance Level") +
  scale_color_manual(values = colors) +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 14),
        axis.text = element_text(size = 12),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10),
        legend.position = "bottom")
```

#--- Creating interaction plot for MPAA variable---#

```{r}
#creating interaction plots
pdf("plots/interaction_mpaa.pdf") 
# calculating mean and SD
mean <- mean(regressionData$Holiday_distance)
sd <- sd(regressionData$Holiday_distance)


# Plotting parameters
theme_set(theme_minimal())
colors <- c("#E41A1C", "#377EB8", "#4DAF4A")

# Plot interactions
ggplot(regressionData, aes(x = AVG_Nmpaa_comp, y = cumulative_rank, color = hd_level)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.2, linetype = "dashed") +
  labs(x = "Average amount of competitor MPAA videos",
       y = "Cumulative Rank",
       color = "Holiday Distance Level") +
  scale_color_manual(values = colors) +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 14),
        axis.text = element_text(size = 12),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10),
        legend.position = "bottom")
```



